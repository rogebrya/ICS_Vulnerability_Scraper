from fastapi import FastAPI
import requests
NVD_api_url = "https://services.nvd.nist.gov/rest/json/cves/1.0/"
NVD_api_key = "?apiKey=45e4addc-5818-445f-83b0-8e77d5594d2a"
#Currently set to gather all vulnerabilities between 2/1/22 and 2/4/22
#Date format:
#yyyy-MM-ddTHH:mm:ss:SSS Z
#Z = -7 for MDT
NVD_start_date = "&pubStartDate=2022-02-01T00:00:00:000 UTC%2D07:00"
NVD_end_date = "&pubEndDate=2022-02-04T00:00:00:000 UTC%2D07:00"

response = requests.get(NVD_api_url+NVD_api_key+NVD_start_date+NVD_end_date)

app = FastAPI()

@app.get("/vulnerabilities")
async def get_vulnerabilities():
    #We can further dissect this response.json() to retreive whatever info we want.
    return response.json()["result"]

