# Python program to convert
# JSON file to CSV
#https://www.geeksforgeeks.org/convert-json-to-csv-in-python/

import json
import csv


# Opening JSON file and loading the data
# into the variable data
with open('data.json') as json_file:
    data = json.load(json_file)

# now we will open a file for writing
data_file = open('data_file.csv', 'w')

# create the csv writer object
csv_writer = csv.writer(data_file)

count = 1

for vuln in data:
    if count == 1:
         # Writing headers to the CSV file
        header = vuln.keys()
        csv_writer.writerow(header)

    cve = data[count-1]

    csv_writer.writerow(vuln.values())
    count += 1


data_file.close()
print("CSV conversion successful.")